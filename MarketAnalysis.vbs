Option ExplicitSub MarketAnalysis()Dim ws As Worksheet    'All Worksheets    For Each ws In Worksheets    ' Sumarytable - Labels    ws.Range("I1").Value = "Ticker"    ws.Range("J1").Value = "Yearly Change"    ws.Range("K1").Value = "Percent Change"    ws.Range("L1").Value = "Total Stock Volume"    ws.Range("O2").Value = "Greatest % Increase"    ws.Range("O3").Value = "Greatest % Decrease"    ws.Range("O4").Value = "Greatest Total Volume"    ws.Range("P1").Value = "Ticker"    ws.Range("Q1").Value = "Value"        'Variables    Dim LastRow As Long    Dim TotalTickerVolume As Double        TotalTickerVolume = 0    Dim TickerName As String    Dim SRow As Long        SRow = 2    Dim YearlyOpen As Double    Dim YearlyClose As Double    Dim YearlyChange As Double    Dim Previous As Long    Previous = 2    Dim PercentChange As Double    Dim GreatestIncrease As Double    GreatestIncrease = 0    Dim GreatestDecrease As Double    GreatestDecrease = 0    Dim LastRowValue As Long    Dim GreatestTotalVolume As Double        GreatestTotalVolume = 0    'c will not work as string    Dim c As Long        'Last Row    LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row        '1rst Loop: TotalTickerVolume and check if the TickerName keeps being the same    'Set and print the TickerName, the Ticker Total Amount in the Sumary Table    'Reset TotalTickerVolume        For c = 2 To LastRow        TotalTickerVolume = TotalTickerVolume + ws.Cells(c, 7).Value        If ws.Cells(c + 1, 1).Value <> ws.Cells(c, 1).Value Then        TickerName = ws.Cells(c, 1).Value        ws.Range("I" & SRow).Value = TickerName        ws.Range("L" & SRow).Value = TotalTickerVolume        TotalTickerVolume = 0        'Setting Yearly Open, Yearly Close        YearlyOpen = ws.Range("C" & Previous)        YearlyClose = ws.Range("F" & c)        YearlyChange = YearlyClose - YearlyOpen        ws.Range("J" & SRow).Value = YearlyChange        'Percent Change - Delta awareness        If YearlyOpen = 0 Then        PercentChange = 0        Else        YearlyOpen = ws.Range("C" & Previous)        PercentChange = YearlyChange / YearlyOpen        End If                ''% Symbol And Two Decimal Places for PercentChange        ws.Range("K" & SRow).NumberFormat = "0.00%"        ws.Range("K" & SRow).Value = PercentChange            'Conditional Formatting        If ws.Range("J" & SRow).Value >= 0 Then        ws.Range("J" & SRow).Interior.ColorIndex = 4        Else        ws.Range("J" & SRow).Interior.ColorIndex = 3        End If                'Summary Table Row - Add 1        SRow = SRow + 1        Previous = c + 1        End If        Next c                        ' Greatest % Increase, Greatest % Decrease and Greatest Total Volume        LastRow = ws.Cells(Rows.Count, 11).End(xlUp).Row                ' 2nd Loop - Final Results        For c = 2 To LastRow        If ws.Range("K" & c).Value > ws.Range("Q2").Value Then        ws.Range("Q2").Value = ws.Range("K" & c).Value        ws.Range("P2").Value = ws.Range("I" & c).Value        End If        If ws.Range("K" & c).Value < ws.Range("Q3").Value Then        ws.Range("Q3").Value = ws.Range("K" & c).Value        ws.Range("P3").Value = ws.Range("I" & c).Value        End If        If ws.Range("L" & c).Value > ws.Range("Q4").Value Then        ws.Range("Q4").Value = ws.Range("L" & c).Value        ws.Range("P4").Value = ws.Range("I" & c).Value        End If        Next c                '% Symbol And Two Decimal Places - Increase & Decrease        ws.Range("Q2").NumberFormat = "0.00%"        ws.Range("Q3").NumberFormat = "0.00%"                    'Auto Fit        ws.Columns("I:Q").AutoFit            NextEnd Sub